---
title: 域名解析过程
date: 2018-08-09 15:49:58
tags:
**www.baidu.com举例**
1. 浏览器会会首先搜索**浏览器自身的DNS缓存**（缓存时间比较短，大概只有1分钟，并且只能容纳1000条缓存），看自身缓存中是否有www.baidu.com中对应的条目，并且没有过期，如果有且没有过期，则解析到此结束。
2. 如果浏览器自身的缓存里面没有找到对应的条目，那么浏览器会搜索**操作系统本身的DNS缓存**，如果找到且没有过期则停止搜索解析到此结束。
3. 如果再Windows系统的DNS缓存中没有找到，那么尝试**读取hosts文件**，文件位于（C:\Windows\System32\drivers\etc），看看这里有没有该域名对应的IP地址，如果有则解析成功。
4.  
    * 如果hosts文件中也没有找到对应的条目，浏览器就会发起一个**DNS的系统调用**，就会向本地配置的首选DNS服务器（一般是电信运营商提供的）发起域名解析请求（通常是UDP协议向DNS的53端口发起请求，这个请求是一个递归请求，也就是运营商的DNS服务器必须得提供给我们该域名的IP地址）
    * 运营商的DNS服务器首先会查找自身的缓存，找到对应条目，且没有过期，则解析成功。如果没有找到对应的条目，则由运营商的DNS代我们的浏览器发起迭代DNS解析请求
    * 它首先会找根域的DNS的IP地址（全球共有13台根服务器，运营商的DNS服务器会内置13台根域的DNS的IP地址），找到根域的DNS地址，就会向其发起请求（请问www.baidu.com这个域名的IP地址是多少啊？），根域发现这是一个顶级域com的一个域名，于是就告诉运营商的DNS我不知道这个域名的IP地址，但是我知道com域的IP地址，你找它去，于是运营商的DNS就得到了con域的IP地址，又向com域的IP地址发起请求（请问www.baidu.com这个域名的IP地址是多少？），com域这台服务器告诉运营商的DNS我不知道www.baidu.com这个域名的IP地址，但是我知道baidu.com这个域名的DNS地址，你去找它去
    * 于是运营商DNS又向baidu.com这个域名的DNS地址（这个一般就是由域名注册商提供的，像万网，新网等）发起请求（请问www.baidu.com这个域名的IP地址是多少？），这个时候baidu.com域的DNS服务器一查，诶，果真在我这里，于是就把找到的结果发送给运营商的DNS服务器
    * 这个时候运营商的DNS服务器就拿到了www.baidu.com这个域名对应的IP地址，并返回Windows系统内核，内核又把结果返回给浏览器，终于浏览器拿到了www.baidu.com的对应IP地址。---
